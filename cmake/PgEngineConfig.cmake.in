@PACKAGE_INIT@

include(CMakeFindDependencyMacro)

# Set up package variables
get_filename_component(PgEngine_CMAKE_DIR "${CMAKE_CURRENT_LIST_FILE}" PATH)
get_filename_component(PgEngine_INSTALL_PREFIX "${PgEngine_CMAKE_DIR}" PATH)
get_filename_component(PgEngine_INSTALL_PREFIX "${PgEngine_INSTALL_PREFIX}" PATH)
get_filename_component(PgEngine_INSTALL_PREFIX "${PgEngine_INSTALL_PREFIX}" PATH)

set(PgEngine_INCLUDE_DIR "${PgEngine_INSTALL_PREFIX}/include")
set(PgEngine_LIB_DIR "${PgEngine_INSTALL_PREFIX}/lib")

# Find the static library
find_library(PgEngine_LIBRARY
    NAMES PgEngine libPgEngine
    PATHS ${PgEngine_LIB_DIR}
    NO_DEFAULT_PATH
)

if(NOT PgEngine_LIBRARY)
    set(PgEngine_FOUND FALSE)
    if(PgEngine_FIND_REQUIRED)
        message(FATAL_ERROR "PgEngine library not found")
    endif()
    return()
endif()

# Create imported target if it doesn't exist
if(NOT TARGET PgEngine::PgEngine)
    add_library(PgEngine::PgEngine STATIC IMPORTED)

    set_target_properties(PgEngine::PgEngine PROPERTIES
        IMPORTED_LOCATION "${PgEngine_LIBRARY}"
        INTERFACE_INCLUDE_DIRECTORIES "${PgEngine_INCLUDE_DIR};${PgEngine_INCLUDE_DIR}/PgEngine;${PgEngine_INCLUDE_DIR}/PgEngine/GameElements"
    )

    # Set up system dependencies that consuming projects need to link
    if(NOT EMSCRIPTEN)
        find_package(OpenGL REQUIRED)

        # On Linux/Windows, consumers need to link system libraries
        if(UNIX AND NOT APPLE)
            set_property(TARGET PgEngine::PgEngine APPEND PROPERTY
                INTERFACE_LINK_LIBRARIES
                OpenGL::GL
                ${CMAKE_DL_LIBS}
                pthread
            )
        elseif(WIN32)
            set_property(TARGET PgEngine::PgEngine APPEND PROPERTY
                INTERFACE_LINK_LIBRARIES
                OpenGL::GL
                winmm
                version
                setupapi
                imm32
            )
        endif()
    endif()
endif()

# Set found flag
set(PgEngine_FOUND TRUE)

# Don't use check_required_components since we're not using exported targets
# check_required_components(PgEngine)